<html>
<head>
<title>Examples/Proximity API</title>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<!--
<script src="//yandex.st/jquery/1.8.3/jquery.min.js"></script>
<link rel="stylesheet" href="//yandex.st/highlightjs/7.3/styles/tomorrow-night-eighties.min.css">
<script src="//yandex.st/highlightjs/7.3/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
-->
</head>
<body>
<h1>Proximity API</h1>
<!--
Open <a href="javascript:(function(F,i,r,e,b,u,g,L,I,T,E){if(F.getElementById(b))return;E=F[i+'NS']&&F.documentElement.namespaceURI;E=E?F[i+'NS'](E,'script'):F[i]('script');E[r]('id',b);E[r]('src',I+g+T);E[r](b,u);(F[e]('head')[0]||F[e]('body')[0]).appendChild(E);E=new%20Image;E[r]('src',I+L);})(document,'createElement','setAttribute','getElementsByTagName','FirebugLite','4','firebug-lite.js','releases/lite/latest/skin/xp/sprite.png','https://getfirebug.com/','#startOpened');">console</a>.
-->
<pre><code class="javascript">
window.addEventListener(
    "deviceproximity",
    function(e){console.log(
        e.value, // текущая дистанция до датчика в сантиметрах (!)
        e.min,   // минимальное значение, которое может определить датчик (==0)
        e.max    // максимальное значение, которое может определить датчик
    )},
    true
);
window.addEventListener(
    "userproximity",
    function(e){console.log(
        e.near //true - близко, false - далеко
    )},
    true
);
</code></pre>

<script>
var logger = new (function(){
    
    var This = this;
    
    this.log = function(text, color){
        var d = document.createElement('div');
        d.innerHTML = text;
        if( color )
            d.style.color = color;
        This.el.appendChild(d);
    };
    this.clear = function(){
        This.el.innerHTML = '';
    }
    
    this.button = document.createElement('input');
    this.button.setAttribute('type', 'button');
    this.button.setAttribute('value', 'Clear log');
    this.button.onclick = this.clear;
    document.body.appendChild(this.button);
    
    this.el = document.createElement('div');
    this.el.style.border='1px dotted #000';
    this.el.style.backgroundColor='#ccc';
    this.el.style.minHeight='200px';
    document.body.appendChild(this.el);
});
window.addEventListener(
    'userproximity',
    function(e) { logger.log(e.type+': '+(e.near ? 'near':'far'), e.near ? '#f00':'#00f'); },
    false
);
window.addEventListener(
    'deviceproximity',
    function(e) { logger.log(e.type+': ' + e.value +', ['+e.min+' ... '+e.max+']'); },
    false
);
</script>

</body>
</html>